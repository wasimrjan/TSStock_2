function HC_Colors()
{
this.ColorArray = [
{nm:"aliceblue",code:"#f0f8ff"},
{nm:"antiquewhite",code:"#faebd7"},
{nm:"aqua",code:"#00ffff"},
{nm:"aquamarine",code:"#7fffd4"},
{nm:"azure",code:"#f0ffff"},
{nm:"beige",code:"#f5f5dc"},
{nm:"bisque",code:"#ffe4c4"},
{nm:"black",code:"#000000"},
{nm:"blanchedalmond",code:"#ffebcd"},
{nm:"blue",code:"#0000ff"},
{nm:"blueviolet",code:"#8a2be2"},
{nm:"brown",code:"#a52a2a"},
{nm:"burlywood",code:"#deb887"},
{nm:"cadetblue",code:"#5f9ea0"},
{nm:"chartreuse",code:"#7fff00"},
{nm:"chocolate",code:"#d2691e"},
{nm:"coral",code:"#ff7f50"},
{nm:"cornflowerblue",code:"#6495ed"},
{nm:"cornsilk",code:"#fff8dc"},
{nm:"crimson",code:"#dc143c"},
{nm:"cyan",code:"#00ffff"},
{nm:"darkblue",code:"#00008b"},
{nm:"darkcyan",code:"#008b8b"},
{nm:"darkgoldenrod",code:"#b8860b"},
{nm:"darkgray",code:"#a9a9a9"},
{nm:"darkgreen",code:"#006400"},
{nm:"darkgrey",code:"#a9a9a9"},
{nm:"darkkhaki",code:"#bdb76b"},
{nm:"darkmagenta",code:"#8b008b"},
{nm:"darkolivegreen",code:"#556b2f"},
{nm:"darkorange",code:"#ff8c00"},
{nm:"darkorchid",code:"#9932cc"},
{nm:"darkred",code:"#8b0000"},
{nm:"darksalmon",code:"#e9967a"},
{nm:"darkseagreen",code:"#8fbc8f"},
{nm:"darkslateblue",code:"#483d8b"},
{nm:"darkslategray",code:"#2f4f4f"},
{nm:"darkslategrey",code:"#2f4f4f"},
{nm:"darkturquoise",code:"#00ced1"},
{nm:"darkviolet",code:"#9400d3"},
{nm:"deeppink",code:"#ff1493"},
{nm:"deepskyblue",code:"#00bfff"},
{nm:"dimgray",code:"#696969"},
{nm:"dimgrey",code:"#696969"},
{nm:"dodgerblue",code:"#1e90ff"},
{nm:"firebrick",code:"#b22222"},
{nm:"floralwhite",code:"#fffaf0"},
{nm:"forestgreen",code:"#228b22"},
{nm:"fuchsia",code:"#ff00ff"},
{nm:"gainsboro",code:"#dcdcdc"},
{nm:"ghostwhite",code:"#f8f8ff"},
{nm:"gold",code:"#ffd700"},
{nm:"goldenrod",code:"#daa520"},
{nm:"gray",code:"#808080"},
{nm:"green",code:"#008000"},
{nm:"greenyellow",code:"#adff2f"},
{nm:"grey",code:"#808080"},
{nm:"honeydew",code:"#f0fff0"},
{nm:"hotpink",code:"#ff69b4"},
{nm:"indianred",code:"#cd5c5c"},
{nm:"indigo",code:"#4b0082"},
{nm:"ivory",code:"#fffff0"},
{nm:"khaki",code:"#f0e68c"},
{nm:"lavender",code:"#e6e6fa"},
{nm:"lavenderblush",code:"#fff0f5"},
{nm:"lawngreen",code:"#7cfc00"},
{nm:"lemonchiffon",code:"#fffacd"},
{nm:"lightblue",code:"#add8e6"},
{nm:"lightcoral",code:"#f08080"},
{nm:"lightcyan",code:"#e0ffff"},
{nm:"lightgoldenrodyellow",code:"#fafad2"},
{nm:"lightgray",code:"#d3d3d3"},
{nm:"lightgreen",code:"#90ee90"},
{nm:"lightgrey",code:"#d3d3d3"},
{nm:"lightpink",code:"#ffb6c1"},
{nm:"lightsalmon",code:"#ffa07a"},
{nm:"lightseagreen",code:"#20b2aa"},
{nm:"lightskyblue",code:"#87cefa"},
{nm:"lightslategray",code:"#778899"},
{nm:"lightslategrey",code:"#778899"},
{nm:"lightsteelblue",code:"#b0c4de"},
{nm:"lightyellow",code:"#ffffe0"},
{nm:"lime",code:"#00ff00"},
{nm:"limegreen",code:"#32cd32"},
{nm:"linen",code:"#faf0e6"},
{nm:"magenta",code:"#ff00ff"},
{nm:"maroon",code:"#800000"},
{nm:"mediumaquamarine",code:"#66cdaa"},
{nm:"mediumblue",code:"#0000cd"},
{nm:"mediumorchid",code:"#ba55d3"},
{nm:"mediumpurple",code:"#9370db"},
{nm:"mediumseagreen",code:"#3cb371"},
{nm:"mediumslateblue",code:"#7b68ee"},
{nm:"mediumspringgreen",code:"#00fa9a"},
{nm:"mediumturquoise",code:"#48d1cc"},
{nm:"mediumvioletred",code:"#c71585"},
{nm:"midnightblue",code:"#191970"},
{nm:"mintcream",code:"#f5fffa"},
{nm:"mistyrose",code:"#ffe4e1"},
{nm:"moccasin",code:"#ffe4b5"},
{nm:"navajowhite",code:"#ffdead"},
{nm:"navy",code:"#000080"},
{nm:"oldlace",code:"#fdf5e6"},
{nm:"olive",code:"#808000"},
{nm:"olivedrab",code:"#6b8e23"},
{nm:"orange",code:"#ffa500"},
{nm:"orangered",code:"#ff4500"},
{nm:"orchid",code:"#da70d6"},
{nm:"palegoldenrod",code:"#eee8aa"},
{nm:"palegreen",code:"#98fb98"},
{nm:"paleturquoise",code:"#afeeee"},
{nm:"palevioletred",code:"#db7093"},
{nm:"papayawhip",code:"#ffefd5"},
{nm:"peachpuff",code:"#ffdab9"},
{nm:"peru",code:"#cd853f"},
{nm:"pink",code:"#ffc0cb"},
{nm:"plum",code:"#dda0dd"},
{nm:"powderblue",code:"#b0e0e6"},
{nm:"purple",code:"#800080"},
{nm:"red",code:"#ff0000"},
{nm:"rosybrown",code:"#bc8f8f"},
{nm:"royalblue",code:"#4169e1"},
{nm:"saddlebrown",code:"#8b4513"},
{nm:"salmon",code:"#fa8072"},
{nm:"sandybrown",code:"#f4a460"},
{nm:"seagreen",code:"#2e8b57"},
{nm:"seashell",code:"#fff5ee"},
{nm:"sienna",code:"#a0522d"},
{nm:"silver",code:"#c0c0c0"},
{nm:"skyblue",code:"#87ceeb"},
{nm:"slateblue",code:"#6a5acd"},
{nm:"slategray",code:"#708090"},
{nm:"slategrey",code:"#708090"},
{nm:"snow",code:"#fffafa"},
{nm:"springgreen",code:"#00ff7f"},
{nm:"steelblue",code:"#4682b4"},
{nm:"tan",code:"#d2b48c"},
{nm:"teal",code:"#008080"},
{nm:"thistle",code:"#d8bfd8"},
{nm:"tomato",code:"#ff6347"},
{nm:"turquoise",code:"#40e0d0"},
{nm:"violet",code:"#ee82ee"},
{nm:"wheat",code:"#f5deb3"},
{nm:"white",code:"#ffffff"},
{nm:"whitesmoke",code:"#f5f5f5"},
{nm:"yellow",code:"#ffff00"},
{nm:"yellowgreen",code:"#9acd32"}
];

this.getColorCount = function()
{
     return this.ColorArray.length;
};

this.getLightColorNameIndex = function(idx)
{
    var cnt = 0;
    for(var i=0;i<this.ColorArray.length;i++){
         if(this.ColorArray[i].nm.substr(0,5)==="light"){
             if(idx===cnt)
                 return this.ColorArray[i].nm;
             cnt++;
         }
     }
     return null;
};

this.getLightColorCodeIndex = function(idx)
{
    var cnt = 0;
    for(var i=0;i<this.ColorArray.length;i++){
         if(this.ColorArray[i].nm.substr(0,5)==="light"){
             if(idx===cnt)
                 return this.ColorArray[i].code;
             cnt++;
         }
     }
     return null;
};

this.getDarkColorCodeIndex = function(idx)
{
    var cnt = 0;
    for(var i=0;i<this.ColorArray.length;i++){
         if(this.ColorArray[i].nm.substr(0,4)==="dark"){
             if(idx===cnt)
                 return this.ColorArray[i].code;
             cnt++;
         }
     }
     return null;
};

this.getDarkColorNameIndex = function(idx)
{
    var cnt = 0;
    for(var i=0;i<this.ColorArray.length;i++){
         if(this.ColorArray[i].nm.substr(0,4)==="dark"){
             if(idx===cnt)
                 return this.ColorArray[i].nm;
             cnt++;
         }
     }
     return null;
};

this.getColorCodeName = function(nm)
{
     for(var i=0;i<this.ColorArray.length;i++){
         if(this.ColorArray[i].nm===nm)
             return this.ColorArray[i].code;
     }
     return null;
};

this.getColorCodeName = function(nm)
{
     for(var i=0;i<this.ColorArray.length;i++){
         if(this.ColorArray[i].nm===nm)
             return this.ColorArray[i].code;
     }
     return null;
};

this.getColorCodeIndex = function(idx)
{
     if(idx<this.ColorArray.length)
        return this.ColorArray[idx].code;
     else
        return null;
};

this.getColorNameIndex = function(idx)
{
     if(idx<this.ColorArray.length)
        return this.ColorArray[idx].nm;
     else
        return null;
};

this.getGraphColorCodeIndex = function(idx){

    if(idx===0)
        return this.getColorCodeName("lightsalmon");
    if(idx===1)
        return this.getColorCodeName("springgreen");
    if(idx===2)
        return this.getColorCodeName("gold");
    if(idx===3)
        return this.getColorCodeName("khaki");
    if(idx===4)
        return this.getColorCodeName("limegreen");
    if(idx===5)
        return this.getColorCodeName("orangered");
    if(idx===6)
        return this.getColorCodeName("aqua");
    if(idx===7)
        return this.getColorCodeName("deepskyblue");
    if(idx===8)
        return this.getColorCodeName("fuchsia");
    if(idx===9)
        return this.getColorCodeName("indigo");
    if(idx===10)
        return this.getColorCodeName("burlywood");
    if(idx===11)
        return this.getColorCodeName("seagreen");
    if(idx===12)
        return this.getColorCodeName("darkviolet");
    if(idx===13)
        return this.getColorCodeName("dimgray");
    if(idx===14)
        return this.getColorCodeName("chocolate");
    if(idx===15)
        return this.getColorCodeName("tomato");
    
};

};




function HC_Graph(GraphName)
{
    this.GraphName = GraphName;
    this.Container = "";
    this.Title = "";
    this.Color = new HC_Colors();
    this.ChartDataSet = {datasets:[]};
    this.ChartLabelArray = null;
    this.Chart = null;
    this.RepType = "S";        //S : Summary , D: Detailed
    this.ChartType = "bar";        //S : Summary , D: Detailed
    this.DurationType = "D";    // D : Daily, W: Weekly, M : Monthly, Y : Yearly
    this.StartDate = null;
    this.EndDate = null;
    this.DateColumn = "";
    this.Date = new HC_Date();
    this.LabelColumn = "";
    this.GraphUpperLimit = 0;
    this.addDataSet = function(lbl,vl){
        try{
        var DataRow = JSON.parse('{"label":"Data","backgroundColor":"","borderColor":"","borderWidth":"2","data":null,"fill":false}');
        DataRow.label = lbl;
        DataRow.data = vl;
        DataRow.backgroundColor = this.Color.getGraphColorCodeIndex(this.ChartDataSet.datasets.length);
        DataRow.borderColor = this.Color.getDarkColorCodeIndex(this.ChartDataSet.datasets.length);
        this.ChartDataSet.datasets.push(DataRow);
        }catch(e){
            alert(e);
        }
    };
    
    
    
    this.getArrayFromKey = function(js,key)
    {
        var ar = [];
        
        for(var i=0;i<js.getArRowLength();i++)
        {
            if(js.getArVK(0,key)!=="")
                if(isNaN(js.getArVK(i,key)))
                    ar[i] = js.getArVK(i,key);
                else    
                    ar[i] = eval(js.getArVK(i,key));
            else
                ar[i] = "";
        }
        return ar;
    };
    
    this.getUpperLimitGraph = function(mxvl)
    {
        var vl = eval(mxvl);
        if(vl<10)
            return 10;
        if(vl<20)
            return 20;
        if(vl<30)
            return 30;
        if(vl<50)
            return 50;
        if(vl<75)
            return 75;
        if(vl<100)
            return 100;
        if(vl<150)
            return 150;
        if(vl<200)
            return 200;
        if(vl<300)
            return 300;
        if(vl<500)
            return 500;
        if(vl<700)
            return 700;
        if(vl<1000)
            return 1000;
        if(vl<1500)
            return 1500;
        if(vl<2000)
            return 2000;
        if(vl<3000)
            return 3000;
        if(vl<4000)
            return 4000;
        if(vl<5000)
            return 5000;
        if(vl<7000)
            return 7000;
        if(vl<9000)
            return 10000;
        if(vl>=9000)
            return (vl + 10000);
    };
    
    this.getMaxVLArray = function(ar)
    {
        var mx = 0;
        for(var i=0;i<ar.length;i++){
            if(ar[i]>mx)
                mx = ar[i];
        }
        return mx;
    };
    
    this.setUpperLimit = function(data)
    {
        var mx = 0;
        var js = new HC_Json(data);
        
        for(var i=0;i<js.getArColumnLength();i++)
        {
            var lbl = js.getArKFI(i,0);
            if(lbl!==this.LabelColumn){
                var nmx = this.getMaxVLArray(this.getArrayFromKey(js,lbl));
                if(nmx!=undefined){
                    if(nmx>mx){
                        mx = nmx;
                    }
                }
            }
        }
        this.GraphUpperLimit = this.getUpperLimitGraph(mx);
    };
    
    this.showChartAjax = function(aj){
        var parent = this;
        
        //alert(aj.AjaxID);
        
        aj.CallServer(function(data){

            //alert(data);
            var js = new HC_Json(data);
            
            parent.ChartLabelArray = parent.getArrayFromKey(js,parent.LabelColumn);
            
            try{
                parent.setUpperLimit(data);
            }catch(ee){
                alert(ee);
            }
            
            for(var i=0;i<js.getArColumnLength();i++)
            {
                var lbl = js.getArKFI(i,0);
                if(lbl!==parent.LabelColumn)
                    parent.addDataSet(lbl,parent.getArrayFromKey(js,lbl));
            }
            parent.showChart();
        });
    };
    
    this.Create = function(pContainer)
    {
        this.Container = pContainer || "";
        this.generate($("#"+this.Container));
    };
    
    this.CreateJObject = function()
    {
        this.generate($("#"+this.Container));
        
    };
    
    this.generate = function(o){
        var id = this.getID();
        o.append("<div id='" + id + "'> <canvas id='" + id + "_canvas'><canvas> <div>");
    };
    
    this.getID = function(){
        if(this.Container!=="")
            return this.Container + "_" + this.GraphName;
        else
            return this.GraphName;
    };
    
    this.Dispose = function(){
        this.Chart = null;
        this.ChartDataSet = {labels:[],datasets:[]};
        this.DataSet = [];
        $("#"+this.getID()+"_canvas").remove();
    };
    
    this.setTitle = function(pHeading){
        this.Title = pHeading;
        if(this.Chart!==null){
            this.Chart.options.title.text = this.Title;
        }
    };
    
    this.showChart = function(){
      
        var c = document.getElementById(this.getID() + "_canvas");
        
        this.Chart = new Chart(c,{
            type: this.ChartType,
            data: {
                  labels: this.ChartLabelArray,
                  datasets: this.ChartDataSet.datasets
            },
            options: {
                scales: {
                yAxes: [{
                  ticks: {
                    beginAtZero: true,
                    max:this.GraphUpperLimit
                  }
                }]
              },
                legend: {
                        position: 'right'
                },
                title: {
                        display: true,
                        position: 'bottom',
                        text: this.Title
                },
                tooltips: {
                    enabled: false
                },
                hover: {
                    animationDuration: 0
                },
                animation: {
                    onComplete: function () {
                        // render the value of the chart above the bar
                        var ctx = this.chart.ctx;
                        ctx.font = Chart.helpers.fontString(Chart.defaults.global.defaultFontSize, 'normal', Chart.defaults.global.defaultFontFamily);
                        ctx.fillStyle = this.chart.config.options.defaultFontColor;
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'bottom';
                        this.data.datasets.forEach(function (dataset) {
                            for (var i = 0; i < dataset.data.length; i++) {
                                var model = dataset._meta[Object.keys(dataset._meta)[0]].data[i]._model;
                                ctx.fillText(dataset.data[i], model.x, model.y - 5);
                            }
                        });
                    }}
            }
            ,responsive: true
           });
        
    };
    
};

function HC_LineGraph(GraphName){
    
    this.GraphName = GraphName;
    this.Container = "";
    this.Heading = "";
    this.Color = new HC_Colors();
    this.ChartDataSet = {labels:[],datasets:[]};
    this.Chart = null;
    this.Limit = new HC_GraphLimit();
    
    
}